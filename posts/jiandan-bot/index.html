<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="zi0n"><title>Jiandan Bot:一个煎蛋爬虫 + telegram bot｜无聊博客</title><meta name=description content="前段时间突然喜欢无聊的时候去煎蛋看看无聊图，可是每天打开浏览器看煎蛋太麻烦(，并且 telegram 现存的一个煎蛋爬虫 channel 只推送热门图片，于是就萌生了写一个爬虫，将所有无聊图发送到我 telegram 的想法。 目前已经写出了基本满足我需"><meta name=keywords content="android,golang,go,安全开发"><link rel="shortcut icon" href=https://blog.5a6c.me/images/favicon.ico><link rel=stylesheet type=text/css media=screen href=https://blog.5a6c.me/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css><link rel=stylesheet type=text/css media=screen href=https://blog.5a6c.me/css/zozo.css><link rel=stylesheet type=text/css media=screen href=https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css><link rel=stylesheet type=text/css media=screen href=https://blog.5a6c.me/css/highlight.css></head><body><div class="main animate__animated animate__fadeInDown"><div class="nav_container animated fadeInDown"><div class=site_nav id=site_nav><ul><li><a href=/>Home</a></li><li><a href=/posts/>Archive</a></li><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li></ul></div></div><div class="header animated fadeInDown"><div class=site_title_container><div class=site_title><h1><a href=https://blog.5a6c.me/><span>无聊博客</span></a></h1></div><div class=description><p class=sub_title>a CURD boy's blog.</p><div class=my_socials><a href=https://github.com/zigitn title=github target=_blank><i class=ri-github-fill></i></a>
<a href=https://blog.5a6c.me/index.xml type=application/rss+xml title=rss target=_blank><i class=ri-rss-fill></i></a></div></div></div></div><div class=content><div class=post_page><div class="post animate__animated animate__fadeInDown"><div class="post_title post_detail_title"><h2><a href=/posts/jiandan-bot/>Jiandan Bot:一个煎蛋爬虫 + telegram bot</a></h2><span class=date>2018.04.11</span></div><div class="post_content markdown"><p>前段时间突然喜欢无聊的时候去煎蛋看看无聊图，可是每天打开浏览器看煎蛋太麻烦(，并且 telegram 现存的一个煎蛋爬虫 channel 只推送热门图片，于是就萌生了写一个爬虫，将所有无聊图发送到我 telegram 的想法。</p><p>目前已经写出了基本满足我需求的稳定版本，<a href=https://github.com/zigitn/jiandanBot>Github 链接在此</a></p><h1 id=主要结构与内容>主要结构与内容</h1><ul><li>bot 目录<ul><li>bot.go 主要为bot的初始化设置</li><li>router.go 为bot接收到命令之后的处理路由</li><li>send.go 为各种消息的send函数</li></ul></li><li>channel 目录<ul><li>channel.go 声明了几个全局 channel，用于供各个模块之间互相传递信息，之前是通过传参的方式将 channel 传到使用的地方，后来发现传参过于繁琐，于是采用全局channel的方式</li></ul></li><li>crawler 目录<ul><li>jiandan.go 为煎蛋的爬虫，之前的版本为爬取网页，后来抓取到了 api，于是采用直接请求 api 的方式，(顺带吐槽一下煎蛋的 api，好多明明是纯数字的字段却是string，导致接过来之后还要转换)</li></ul></li><li>maker 目录<ul><li>jiandan.go 爬虫将爬到的 json 格式的数据通过 channel 传递给 maker，maker将其处理为telegram bot的格式</li></ul></li></ul><h1 id=配置文件格式>配置文件格式</h1><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span>
    <span class=nt>&#34;Token&#34;</span><span class=p>:</span> <span class=s2>&#34;YOUR_TOKEN&#34;</span><span class=p>,</span>
    <span class=nt>&#34;AdminID&#34;</span><span class=p>:</span> <span class=mi>000000</span><span class=p>,</span>
    <span class=nt>&#34;ChannelID&#34;</span><span class=p>:</span> <span class=mi>000000</span><span class=p>,</span>
    <span class=nt>&#34;ChannelUsername&#34;</span><span class=p>:</span> <span class=s2>&#34;@YOUTR_CHANNEL_NAME&#34;</span><span class=p>,</span>
    <span class=nt>&#34;ApiAddress&#34;</span><span class=p>:</span> <span class=s2>&#34;jandan.net_api&#34;</span>
<span class=p>}</span>
</code></pre></div></div><div class=post_footer><div class=meta><div class=info><span class="field tags"><i class=ri-stack-line></i>
<a href=https://blog.5a6c.me/tags/telegram/>telegram</a>
<a href=https://blog.5a6c.me/tags/%E7%88%AC%E8%99%AB/>爬虫</a>
<a href=https://blog.5a6c.me/tags/%E7%85%8E%E8%9B%8B/>煎蛋</a></span></div></div></div></div><div class=doc_comments></div></div></div></div><a id=back_to_top href=# class=back_to_top><i class=ri-arrow-up-s-line></i></a><footer class=footer><div class=firends_links><span>友情链接:</span>
<a href=https://louisnie.github.io/>louisnie</a>
<a href=https://deconf.xyz/>deconf</a></div><div class=powered_by><span>Theme based on <a href=https://varkai.com>zozo</a>.</span>
<span>Power by <a href=http://www.gohugo.io/>Hugo</a>, solitude and love</span></div></footer><script src=https://blog.5a6c.me/js/jquery-3.5.1.min.js></script><link href=https://blog.5a6c.me/css/fancybox.min.css rel=stylesheet><script src=https://blog.5a6c.me/js/fancybox.min.js></script><script src=https://blog.5a6c.me/js/zozo.js></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-144516028-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>